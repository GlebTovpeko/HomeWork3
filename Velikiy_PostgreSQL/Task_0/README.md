# üîß –ó–∞–¥–∞–Ω–∏–µ 0 (–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL 16 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ansible)

Tasks:

    0.0. –í–æ—Ç–∫–Ω—É—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–∫ –≤ –≤–∞—à—É –≤–∏—Ä—Ç—É–∞–ª–∫—É (–Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—é –Ω–∞ —Ç–µ–∫—É—â–µ–º –¥–∏—Å–∫–µ) –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –¥–∏—Å–∫–∞ –ø–æ–¥ –¥–∞–Ω–Ω—ã–µ –±–∞–∑—ã;
    0.1. —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å postgresql.

*–†—É–∫–∞–º–∏ –ø—Ä–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Å—Ç–∞–Ω—Å –ë–î —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –ø–∞–ø–∫–µ /pg_data/16/*

---
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL 16 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ansible (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#1-–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#2-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
3. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∏—Å–∫–æ–≤](#3-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–¥–∏—Å–∫–æ–≤)
4. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ Ansible](#4-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–ø—Ä–æ–µ–∫—Ç–∞-ansible)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Ansible Vault](#5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-ansible-vault)
6. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã](#6-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ-—Ñ–∞–π–ª—ã)
7. [Playbook –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL](#7-playbook-–¥–ª—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∏-postgresql)
8. [–ó–∞–ø—É—Å–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞](#8-–∑–∞–ø—É—Å–∫-–∏-–ø—Ä–æ–≤–µ—Ä–∫–∞)
9. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#9-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
10. [–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç](#10-–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π-—á–µ–∫-–ª–∏—Å—Ç)

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–í –¥–∞–Ω–Ω–æ–º —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ –æ–ø–∏—Å–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL 16 –Ω–∞ –¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Ansible. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–µ–Ω–æ:

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –¥–∏—Å–∫–∞ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ë–î (`/pg_data`)
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—é –ø–∞—Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ Ansible Vault
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ |
|-----------|------------|
| –û–° | Debian 13 |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ | 2 |
| Ansible | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —É–ø—Ä–∞–≤–ª—è—é—â–µ–π –º–∞—à–∏–Ω–µ |
| SSH | –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä–∞–º –ø–æ –∫–ª—é—á—É |
| –î–∏—Å–∫ | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∏—Å–∫ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –ë–î |

![–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –º–∞—à–∏–Ω—ã](photos/image.png)
---

## 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### 2.1. Server1 - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –Ω—É–ª—è

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Debian –Ω–∞ –ø–µ—Ä–≤—ã–π —Å–µ—Ä–≤–µ—Ä –¥–æ–±–∞–≤—å—Ç–µ –≤—Ç–æ—Ä–æ–π –¥–∏—Å–∫ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö PostgreSQL.

**–®–∞–≥ 1:** –ù–∞ —ç—Ç–∞–ø–µ —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∏—Å–∫–æ–≤ –≤—ã–±–µ—Ä–∏—Ç–µ —Ä—É—á–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ (Manual partitioning)

**–®–∞–≥ 2:** –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–≤—ã–π –¥–∏—Å–∫ (`/dev/vda`) –¥–ª—è —Å–∏—Å—Ç–µ–º—ã:

| –¢–æ—á–∫–∞ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –†–∞–∑–º–µ—Ä | –¢–∏–ø |
|-------------------|--------|-----|
| `/boot/efi` | 512 MB | EFI System Partition |
| `/boot` | 1 GB | ext2 |
| `[SWAP]` | 2 GB | swap |
| `/` | 20 GB | ext4 |




–†–∏—Å—É–Ω–æ–∫ 2 - –†–∞–∑–±–∏–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥–∏—Å–∫–∞

*–ù–∞ —Ä–∏—Å—É–Ω–∫–µ –≤—ã—à–µ –ø–æ–∫–∞–∑–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ –Ω–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–º –¥–∏—Å–∫–µ.*



**–®–∞–≥ 3:** –ù–∞ –≤—Ç–æ—Ä–æ–º –¥–∏—Å–∫–µ (`/dev/vdb`)  - —Å–æ–∑–¥–∞–¥–∏–º —Ä–∞–∑–¥–µ–ª /pg_data.

*–ö–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ.*

---

### 2.2. Server2 - –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–∫–∞

–ù–∞ –≤—Ç–æ—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–µ Debian —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –î–æ–±–∞–≤–∏–º –≤—Ç–æ—Ä–æ–π –¥–∏—Å–∫ –∏ —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.

**–®–∞–≥ 1:** –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∏—Å–∫–∏:

```bash
lsblk
```

üìã –ò—Ç–æ–≥
‚úÖ PostgreSQL 16 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
‚úÖ –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ /pg_data/16/ (–Ω–∞ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∏—Å–∫–µ)
‚úÖ –°–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∏ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–µ
‚úÖ –ü–∞—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ Vault –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤
‚úÖ Playbook –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–µ–Ω (–º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ)
---
**–ì–ª–∞–≤–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∏ –±—É–¥—É—â–∏–π devops-–µ—Ä:** –¢–æ–≤–ø–µ–∫–æ –ì–ª–µ–± –í–∞–¥–∏–º–æ–≤–∏—á, –≥—Ä—É–ø–ø–∞ K0109-23
